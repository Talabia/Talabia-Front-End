<p-card [header]="'analytics.dashboard.header' | translate">
    <div class="card">
        <!-- Filters Section -->
        <div class="action-container">
            <p-select [options]="filterOptions" [(ngModel)]="selectedFilter"
                [placeholder]="'analytics.dashboard.filterPlaceholder' | translate" [disabled]="loading"
                [showClear]="true" (onChange)="onFilterChange()" />

            <p-button [label]="'analytics.dashboard.refresh' | translate" icon="pi pi-refresh" severity="secondary"
                [loading]="loading" (click)="loadDashboardData()" />
        </div>

        <!-- Loading Spinner -->
        @if (loading) {
        <div class="loading-container">
            <p-progressSpinner />
            <p>{{ loadingMessage }}</p>
        </div>
        }

        <!-- Dashboard Content -->
        @if (!loading && statistics) {
        <!-- Summary Cards -->
        <div class="summary-container">
            <div class="summary-card">
                <div class="card-content">
                    <div class="card-icon">
                        <i class="pi pi-chart-bar"></i>
                    </div>
                    <div class="card-info">
                        <h3>{{getTotalReports()}}</h3>
                        <p>{{'analytics.dashboard.totalReports' | translate}}</p>
                    </div>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-content">
                    <div class="card-icon">
                        <i class="pi pi-clock"></i>
                    </div>
                    <div class="card-info">
                        <h3>{{statistics.pendingReports}}</h3>
                        <p>{{'analytics.dashboard.pending' | translate}}</p>
                        <small>{{getStatusPercentage('pending')}}{{'analytics.dashboard.ofTotal' | translate}}</small>
                    </div>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-content">
                    <div class="card-icon">
                        <i class="pi pi-eye"></i>
                    </div>
                    <div class="card-info">
                        <h3>{{statistics.underReviewReports}}</h3>
                        <p>{{'analytics.dashboard.underReview' | translate}}</p>
                        <small>{{getStatusPercentage('underReview')}}{{'analytics.dashboard.ofTotal' |
                            translate}}</small>
                    </div>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-content">
                    <div class="card-icon">
                        <i class="pi pi-check-circle"></i>
                    </div>
                    <div class="card-info">
                        <h3>{{statistics.resolvedReports}}</h3>
                        <p>{{'analytics.dashboard.resolved' | translate}}</p>
                        <small>{{getStatusPercentage('resolved')}}{{'analytics.dashboard.ofTotal' | translate}}</small>
                    </div>
                </div>
            </div>

            <div class="summary-card">
                <div class="card-content">
                    <div class="card-icon">
                        <i class="pi pi-times-circle"></i>
                    </div>
                    <div class="card-info">
                        <h3>{{statistics.rejectedReports}}</h3>
                        <p>{{'analytics.dashboard.rejected' | translate}}</p>
                        <small>{{getStatusPercentage('rejected')}}{{'analytics.dashboard.ofTotal' | translate}}</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-container">
            <!-- Status Distribution Chart -->
            <div class="chart-card">
                <h4 class="chart-title">{{'analytics.dashboard.statusChartTitle' | translate}}</h4>
                @if (statusChartData) {
                <p-chart type="pie" [data]="statusChartData" [options]="pieChartOptions" height="300px" />
                }
            </div>

            <!-- Type Distribution Chart -->
            <div class="chart-card">
                <h4 class="chart-title">{{'analytics.dashboard.typeChartTitle' | translate}}</h4>
                @if (typeChartData) {
                <p-chart type="doughnut" [data]="typeChartData" [options]="pieChartOptions" height="300px" />
                }
            </div>

            <!-- Reason Distribution Chart -->
            <div class="chart-card">
                <h4 class="chart-title">{{'analytics.dashboard.reasonChartTitle' | translate}}</h4>
                @if (reasonChartData) {
                <p-chart type="bar" [data]="reasonChartData" [options]="barChartOptions" height="400px" />
                }
            </div>

            <!-- Timeline Chart -->
            <div class="chart-card">
                <h4 class="chart-title">{{'analytics.dashboard.timelineChartTitle' | translate}}</h4>
                @if (timelineChartData) {
                <p-chart type="line" [data]="timelineChartData" [options]="lineChartOptions" height="400px" />
                }
            </div>
        </div>
        }

        <!-- Empty State -->
        @if (!loading && !statistics) {
        <div class="empty-container">
            <i class="pi pi-chart-bar"></i>
            <h4>{{'analytics.dashboard.emptyTitle' | translate}}</h4>
            <p>{{'analytics.dashboard.emptyDescription' | translate}}</p>
            <p-button [label]="'analytics.dashboard.retry' | translate" icon="pi pi-refresh" severity="primary"
                (click)="loadDashboardData()" />
        </div>
        }
    </div>
</p-card>
<p-toast />